<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords" content="" />
<title>Check Out</title>
<link href="/css/bootstrap.css" rel="stylesheet" type="text/css" media="all" />
<!-- Custom Theme files -->
<!--theme-style-->
<link href="/css/style.css" rel="stylesheet" type="text/css" media="all" />	
<!--//theme-style-->
<!--theme-style-->
<link href="/css/style4.css" rel="stylesheet" type="text/css" media="all" />
<link href="/css/popuo-box.css" rel="stylesheet" type="text/css" media="all"/>
<link rel="stylesheet" href="/css/chocolat.css" type="text/css" media="screen" />
<link rel="stylesheet" href="/css/jstarbox.css" type="text/css" media="screen" />
<style type="text/css">
.col-pic{
	display:none;
}
</style>
<!--//theme-style-->

<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
<script src="/js/jquery.min.js"></script>
<!--- start-rate---->
<script src="/js/jstarbox.js"></script>
<script src="/js/jquery.magnific-popup.js" type="text/javascript"></script>
<script type="text/javascript">
$(function() {
	$('.starbox').each(function() {
		var starbox = $(this);
		starbox.starbox({
			average: starbox.attr('data-start-value'),
			changeable: starbox.hasClass('unchangeable') ? false : starbox.hasClass('clickonce') ? 'once' : true,
			ghosting: starbox.hasClass('ghosting'),
			autoUpdateAverage: starbox.hasClass('autoupdate'),
			buttons: starbox.hasClass('smooth') ? false : starbox.attr('data-button-count') || 5,
			stars: starbox.attr('data-star-count') || 5
		}).bind('starbox-value-changed', function(event, value) {
			if(starbox.hasClass('random')) {
				var val = Math.random();
				starbox.next().text(' '+val);
				return val;
			} 
		});
	});
		
	$('.popup-with-zoom-anim').magnificPopup({
		type: 'inline',
		fixedContentPos: false,
		fixedBgPos: true,
		overflowY: 'auto',
		closeBtnInside: true,
		preloader: false,
		midClick: true,
		removalDelay: 300,
		mainClass: 'my-mfp-zoom-in'
	});
	
});
</script>

<!-- <script>$(document).ready(function(c) {
		$('.close1').on('click', function(c){
			$('.cart-header').fadeOut('slow', function(c){
				$('.cart-header').remove();
			});
			});	  
		});
   </script> -->

</head>
<body>

<!--header-->
<div class="header">
<div class="container">
		<div class="head">
			<div class=" logo">
				<a href="/"><img src="images/logo.png" alt=""></a>	
			</div>
		</div>
	</div>
	<div class="header-top">
		<div class="container">
		<div class="col-sm-5 col-md-offset-2  header-login">
					<ul th:if="${session.login == null }">
						<li><a href="/toLogin">登陆</a></li>
						<li><a href="/toRegister">注册</a></li>
						<li><a href="/toManagerLogin">管理员登陆</a></li>
					</ul>
					<ul th:if="${session.login != null }">
						<li><span style="color:white;">欢迎您，</span><a href="#" th:text="${session.login.userName}">未登录</a></li>
						<li><a href="/logout">注销</a></li>
						<li><a th:href="@{'/checkout?id=' + ${session.login.userId}}">我的购物车</a></li>
					</ul>
				</div>
				
			<div class="col-sm-5 header-social">		
					<ul >
						<li><a href="#"><i></i></a></li>
						<li><a href="#"><i class="ic1"></i></a></li>
						<li><a href="#"><i class="ic2"></i></a></li>
						<li><a href="#"><i class="ic3"></i></a></li>
						<li><a href="#"><i class="ic4"></i></a></li>
					</ul>
					
			</div>
				<div class="clearfix"> </div>
		</div>
		</div>
		
		<div class="container">
		
			<div class="head-top">
			
		 <div class="col-sm-8 col-md-offset-2 h_menu4">
				<nav class="navbar nav_bottom" role="navigation">
 
 <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header nav_2">
      <button type="button" class="navbar-toggle collapsed navbar-toggle1" data-toggle="collapse" data-target="#bs-megadropdown-tabs">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
     
   </div> 
   <!-- Collect the nav links, forms, and other content for toggling -->
     <div class="collapse navbar-collapse" id="bs-megadropdown-tabs">
        <ul class="nav navbar-nav nav_1">
            <li><a class="color" href="/">首页</a></li>
            
    		<li class="dropdown mega-dropdown active">
			    <a href="#" class="color1 dropdown-toggle" data-toggle="dropdown">封面<span class="caret"></span></a>				
				<div class="dropdown-menu ">
                    <div class="menu-top">
						<div class="col1">
							<div class="h_nav">
								<h4>色调</h4>
									<ul>
										<li><a href="/product?product=cover&type=color&data=冷色系">冷色系</a></li>
										<li><a href="/product?product=cover&type=color&data=暖色系">暖色系</a></li>
										<li><a href="/product?product=cover&type=color&data=极简·纯白">极简·纯白</a></li>
										<li><a href="/product?product=cover&type=color&data=极简·墨黑">极简·墨黑</a></li>
										<li><a href="/product?product=cover&type=color&data=极致·绚烂">极致·绚烂</a></li>
									</ul>	
							</div>							
						</div>
						<div class="col1">
							<div class="h_nav">
								<h4>尺寸</h4>
								<ul>
										<li><a href="/product?product=cover&type=size&data=A4">A4</a></li>
										<li><a href="/product?product=cover&type=size&data=A5">A5</a></li>
										<li><a href="/product?product=cover&type=size&data=B4">B4</a></li>
										<li><a href="/product?product=cover&type=size&data=B5">B5</a></li>
										<li><a href="/product?product=cover&type=size&data=N8">N8</a></li>
										<li><a href="/product?product=cover&type=size&data=N10">N10</a></li>
									</ul>	
							</div>							
						</div>
						<div class="col1">
							<div class="h_nav">
								<h4>价格</h4>
									<ul>
										<li><a href="/product?product=cover&type=price&data=19l">＜ 19</a></li>
										<li><a href="/product?product=cover&type=price&data=19m49l">19 ~ 49</a></li>
										<li><a href="/product?product=cover&type=price&data=49m99l">49 ~ 99</a></li>
										<li><a href="/product?product=cover&type=price&data=99m199l">99 ~ 199</a></li>
										<li><a href="/product?product=cover&type=price&data=199m">＞ 199</a></li>
										
									</ul>	
								
							</div>							
						</div>
						<div class="col1 col5" style="float:right;">
						<img src="images/me.png" class="img-responsive" alt="">
						</div>
						<div class="clearfix"></div>
					</div>                  
				</div>				
			</li>
			<li class="dropdown mega-dropdown active">
			    <a href="#" class="color2 dropdown-toggle" data-toggle="dropdown">内页<span class="caret"></span></a>				
				<div class="dropdown-menu mega-dropdown-menu">
                    <div class="menu-top">
						<div class="col1">
							<div class="h_nav">
								<h4>色调</h4>
									<ul>
										<li><a href="/product?product=style&type=color&data=冷色系">冷色系</a></li>
										<li><a href="/product?product=style&type=color&data=暖色系">暖色系</a></li>
										<li><a href="/product?product=style&type=color&data=极简·纯白">极简·纯白</a></li>
										<li><a href="/product?product=style&type=color&data=极简·墨黑">极简·墨黑</a></li>
										<li><a href="/product?product=style&type=color&data=极致·绚烂">极致·绚烂</a></li>
									</ul>
							</div>							
						</div>
						<div class="col1">
							<div class="h_nav">
								<h4>材质</h4>
								<ul>
										<li><a href="/product?product=style&type=material&data=牛皮纸">牛皮纸</a></li>
										<li><a href="/product?product=style&type=material&data=仿皮纸">仿皮纸</a></li>
										<li><a href="/product?product=style&type=material&data=硫酸纸">硫酸纸</a></li>
										<li><a href="/product?product=style&type=material&data=牛宣纸">宣纸</a></li>
										<li><a href="/product?product=style&type=material&data=信笺纸">信笺纸</a></li>
										<li><a href="/product?product=style&type=material&data=黄皮纸">黄皮纸</a></li>
									</ul>	
							</div>							
						</div>
						<div class="col1">
							<div class="h_nav">
								<h4>价格</h4>
									<ul>
										<li><a href="/product?product=style&type=price&data=19l">＜ 1.9</a></li>
										<li><a href="/product?product=style&type=price&data=19m49l">1.9 ~ 4.9</a></li>
										<li><a href="/product?product=style&type=price&data=49m99l">4.9 ~ 9.9</a></li>
										<li><a href="/product?product=style&type=price&data=99m199l">9.9 ~ 19.9</a></li>
										<li><a href="/product?product=style&type=price&data=199m">＞ 19.9</a></li>
										
									</ul>	
								
							</div>							
						</div>
						<div class="col1 col5" style="float:right;">
						<img src="images/me1.png" class="img-responsive" alt="">
						</div>
						<div class="clearfix"></div>
					</div>                  
				</div>				
			</li>
			<li><a class="color3" href="/product?product=all">热销</a></li>
			<li><a class="color4" href="/contact">支持</a></li>
            <li><a class="color5" href="/product?product=all">特价</a></li>
            <li ><a class="color6" href="/contact">联系我们</a></li>
        </ul>
     </div><!-- /.navbar-collapse -->

</nav>
			</div>
			<div class="col-sm-2 search-right">
				<ul class="heart">
				<li>
				<a href="/wishlist" >
				<span class="glyphicon glyphicon-heart" aria-hidden="true"></span>
				</a></li>
				<li><a class="play-icon popup-with-zoom-anim" href="#small-dialog"><i class="glyphicon glyphicon-search"> </i></a></li>
					</ul>
					<div class="cart box_1">
						<a th:href="@{'/checkout?id=' + ${session.login.userId }}" class="total">
							<span class="simpleCart_total1"></span> <!-- 原来：<span class="simpleCart_total"></span>  -->
							<img src="images/cart.png" alt=""/>
						</a>
						<p><a href="/clearPack" class="simpleCart_empty">清空购物车</a></p>

					</div>
					<div class="clearfix"> </div>
					
			<!---//pop-up-box---->
			<div id="small-dialog" class="mfp-hide">
				<div class="search-top">
					<div class="login-search">
						<input type="submit" value="">
						<input type="text" value="Search.." onfocus="this.value = '';" onblur="if (this.value == '') {this.value = 'Search..';}">		
					</div>
					<p>搜索</p>
				</div>				
			</div>	<!----->
			</div>
			<div class="clearfix"></div>
		</div>	
	</div>	
</div>
<!--banner-->
<div class="banner-top">
	<div class="container">
		<h1>购物车</h1>
		<em></em>
		<h2><a href="/">首页</a><label>/</label>购物车</h2>
	</div>
</div>
<!--login-->
	
<div class="container">
	<div class="check-out">
	<div class="bs-example4" data-example-id="simple-responsive-table">
    <div class="table-responsive">
    	    <table class="table-heading simpleCart_shelfItem">
		  <tr>
			<th class="table-grid">商品</th>
					
			<th>价格</th>
			<th>派送费 </th>
			<th></th>
			<th>数量</th>
			<th></th>
			<th>总价</th>
		  </tr>
		  
		  <tr th:if="${null == cover || null == style || cover.size()+style.size() == 0}">
		  	<td colspan="7" align="center" style="font-size: 1.325em;">你的购物车空空如也~
		  	</td>
		  </tr>
		  
		  <tr th:if="${null != cover}" th:each="v,l:${cover}" th:classappend="'cart-header' + ${l.count }">

			<td class="ring-in"><a th:href="@{'/single?product=cover&id=' + ${v.coverId }}" class="at-in"><img th:src="@{${v.coverImage} + '.jpg'}" class="img-responsive" alt=""></a>
			<div class="sed">
				<h5><a th:href="@{'/single?product=cover&id=' + ${v.coverId }}" th:text="'封面·' + ${v.coverName }">无效th标签</a></h5>
				<p>( 北岛初晴风光，便如一道彩虹温柔了雨季 ) </p>
			
			</div>
			<div class="clearfix"> </div>
			<div th:classappend="'close' + ${l.count}" th:data-value="'cover-' + ${v.coverId}"> </div></td>
			<td class="single_price" th:text="'￥ '  + ${v.coverPrice }">无效th标签</td>
			<td>免邮</td>
			<td class="add-check"><a class="item_sub hvr-skew-backward">-</a></td>
			<td class="item_count">1</td>
			<td class="add-check"><a class="item_add hvr-skew-backward">+</a></td>
			<td class="item_price">js不支持</td>
		  </tr>
		  
		  	<tr th:if="${null != style}" th:each="v,l:${style}" class="" th:classappend="'cart-header' + ${cover.size() + l.count }">

			<td class="ring-in"><a th:href="@{'/single?product=style&id=' + ${v.styleId }}" class="at-in"><img th:src="@{${v.styleImage} + '.jpg'}" class="img-responsive" alt=""></a>
			<div class="sed">
				<h5><a th:href="@{'/single?product=style&id=' + ${v.styleId }}" th:text="'内页·' + ${v.styleName }">无效th标签</a></h5>
				<p>( 北岛初晴风光，便如一道彩虹温柔了雨季 ) </p>
			
			</div>
			<div class="clearfix"> </div>
			<div th:classappend="'close' + ${cover.size() + l.count}" th:data-value="'style-' + ${v.styleId}"> </div></td>
			<td class="single_price" th:text="'￥ '  + ${v.stylePrice }">无效th标签</td>
			<td>免邮</td>
			<td class="add-check"><a class="item_sub hvr-skew-backward">-</a></td>
			<td class="item_count">1</td>
			<td class="add-check"><a class="item_add hvr-skew-backward">+</a></td>
			<td class="item_price">js不支持</td>
			
		  </tr>
		  
	</table>
	</div>
	</div>
	<div class="produced">
	<a href="/clearPack" class="hvr-skew-backward" id="IWantAll">全部购买</a>
	 </div>
    </div>
</div>

<!--//login-->
<!--brand-->
		<div class="container">
			<div class="brand">
				<div class="col-md-3 brand-grid">
					<img src="images/ic.png" class="img-responsive" alt="">
				</div>
				<div class="col-md-3 brand-grid">
					<img src="images/ic1.png" class="img-responsive" alt="">
				</div>
				<div class="col-md-3 brand-grid">
					<img src="images/ic2.png" class="img-responsive" alt="">
				</div>
				<div class="col-md-3 brand-grid">
					<img src="images/ic3.png" class="img-responsive" alt="">
				</div>
				<div class="clearfix"></div>
			</div>
			</div>
	<!--//content-->
	
	<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->

	<script src="/js/simpleCart.min.js"> </script>
<!-- slide -->
<script src="/js/bootstrap.min.js"></script>
<script type="text/javascript">
	$(function(){
		initSumPrice();
		$(".item_add").click(function(){
			itemAdd(this);
		});
		$(".item_sub").click(function(){
			itemSub(this);
		});
		/* $(".simpleCart_empty").click(function(){
			$(".simpleCart_total1").text("￥0.0");
			$(".item_count").each(function(){
				$(this).text("0");
			});
			$(".item_price").each(function(){
				$(this).text("￥0.0");
			});
		}); */
		
	});
	
	function initSumPrice(){
		$(".item_price").each(function(){
			$(this).text("￥" + sumPriceCount(this));
		});
		$(".simpleCart_total1").text("￥" + cartTotalCount());
	};
	
	function sumPriceCount(obj){
		var count = parseFloat($(obj).parent("tr").children(".item_count").text().match(/\d+/g)).toFixed(1);
		var singlePrice = parseFloat($(obj).parent("tr").children(".single_price").text().match(/\d+\.\d+/g));
		var sumPrice = parseFloat(count * singlePrice).toFixed(1);
		return sumPrice;
	};
	
	function cartTotalCount(){
		var count = 0.0;
		$(".item_price").each(function(){
			count = parseFloat(Number(count) + parseFloat($(this).text().match(/\d+(\.\d*)?/g))).toFixed(1);
		});
		return count;
	};
	
	function itemAdd(obj){
		var itemCount = parseInt($(obj).parent("td").parent("tr").children(".item_count").text().match(/\d+/g));
		$(obj).parent("td").parent("tr").children(".item_count").text(++itemCount);
		initSumPrice();
	};
	
	function itemSub(obj){
		var itemCount = parseInt($(obj).parent("td").parent("tr").children(".item_count").text().match(/\d+/g));
		if(itemCount == 0){
			return;
		}
		$(obj).parent("td").parent("tr").children(".item_count").text(--itemCount);
		initSumPrice();
	};
	
	$("div.produced").on("click", 'a#IWantAll', function(){
		alert("购买成功!");
	});
	
	$('div[class*="close"]').on("click", function(c){
		var v = $(this).data("value").split("-");
		var product = '{"product": "' + v[0] + '", "id": "' + v[1] + '"}';
		$.ajax({
			type: "POST",
			url: "/removeProduct",
			data: product,
			contentType: "application/json;charset=UTF-8",
			dataType: 'json',
			success: function(data){
			},
			error: function(data){
				alert(data);
				return;
			}
		});
		var id = $(this).attr("class");
		var numid = id.replace(/[a-zA-Z]/g, "");
		$(".cart-header" + numid).fadeOut('slow', function(c){
			$(".cart-header" + numid).remove();
			initSumPrice();
		});
	});
	
	
</script>
 
</body>
</html>